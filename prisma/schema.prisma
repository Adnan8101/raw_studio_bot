generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AntiNukeConfig {
  id          String   @id @default(cuid())
  guildId     String   @unique @map("guild_id")
  enabled     Boolean  @default(false)
  protections String
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([guildId])
  @@map("antinuke_config")
}

model AntiNukeLimit {
  id         String   @id @default(cuid())
  guildId    String   @map("guild_id")
  action     String
  limitCount Int      @map("limit_count")
  windowMs   Int      @default(10000) @map("window_ms")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  @@unique([guildId, action])
  @@index([guildId])
  @@map("antinuke_limits")
}

model AntiNukePunishment {
  id              String   @id @default(cuid())
  guildId         String   @map("guild_id")
  action          String
  punishment      String
  durationSeconds Int?     @map("duration_seconds")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  @@unique([guildId, action])
  @@index([guildId])
  @@map("antinuke_punishments")
}

model AntiNukeAction {
  id         String   @id @default(cuid())
  guildId    String   @map("guild_id")
  userId     String   @map("user_id")
  action     String
  targetId   String?  @map("target_id")
  timestamp  DateTime @default(now())
  auditLogId String?  @map("audit_log_id")
  metadata   String?

  @@index([guildId, userId, action, timestamp])
  @@index([guildId, timestamp])
  @@map("antinuke_actions")
}

model Whitelist {
  id        String   @id @default(cuid())
  guildId   String   @map("guild_id")
  targetId  String   @map("target_id")
  isRole    Boolean  @map("is_role")
  category  String
  createdAt DateTime @default(now()) @map("created_at")
  createdBy String   @map("created_by")

  @@unique([guildId, targetId, category])
  @@index([guildId, targetId])
  @@index([guildId, category])
  @@map("whitelist")
}

model GuildLogging {
  id              String   @id @default(cuid())
  guildId         String   @unique @map("guild_id")
  modChannel      String?  @map("mod_channel")
  securityChannel String?  @map("security_channel")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  @@map("guild_logging")
}

model ModerationCase {
  id           String    @id @default(cuid())
  caseNumber   Int       @map("case_number")
  guildId      String    @map("guild_id")
  targetId     String    @map("target_id")
  moderatorId  String    @map("moderator_id")
  action       String
  reason       String?
  metadata     String?
  overturned   Boolean   @default(false)
  overturnedBy String?   @map("overturned_by")
  overturnedAt DateTime? @map("overturned_at")
  createdAt    DateTime  @default(now()) @map("created_at")

  @@unique([guildId, caseNumber])
  @@index([guildId, targetId])
  @@index([guildId, createdAt])
  @@map("moderation_cases")
}

model RoleBackup {
  id          String   @id @default(cuid())
  guildId     String   @map("guild_id")
  roleId      String   @map("role_id")
  name        String
  color       Int
  position    Int
  permissions String
  hoist       Boolean
  mentionable Boolean
  icon        String?
  metadata    String?
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([guildId, createdAt])
  @@map("role_backups")
}

model ChannelBackup {
  id                   String   @id @default(cuid())
  guildId              String   @map("guild_id")
  channelId            String   @map("channel_id")
  name                 String
  type                 Int
  position             Int
  parentId             String?  @map("parent_id")
  topic                String?
  nsfw                 Boolean  @default(false)
  permissionOverwrites String?  @map("permission_overwrites")
  metadata             String?
  createdAt            DateTime @default(now()) @map("created_at")

  @@index([guildId, createdAt])
  @@map("channel_backups")
}

model JobQueue {
  id          String    @id @default(cuid())
  name        String
  data        String
  priority    Int       @default(0)
  state       String    @default("created")
  retryCount  Int       @default(0) @map("retry_count")
  retryLimit  Int       @default(3) @map("retry_limit")
  error       String?
  startedAt   DateTime? @map("started_at")
  completedAt DateTime? @map("completed_at")
  createdAt   DateTime  @default(now()) @map("created_at")

  @@index([state, priority, createdAt])
  @@index([name, state])
  @@map("job_queue")
}

model AutoResponder {
  id        String   @id @default(cuid())
  guildId   String   @map("guild_id")
  trigger   String
  response  String
  enabled   Boolean  @default(true)
  createdBy String   @map("created_by")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@unique([guildId, trigger])
  @@index([guildId, enabled])
  @@map("auto_responders")
}

model Warn {
  id          String   @id @default(cuid())
  guildId     String   @map("guild_id")
  userId      String   @map("user_id")
  moderatorId String   @map("moderator_id")
  reason      String?
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([guildId, userId])
  @@index([guildId, createdAt])
  @@map("warns")
}

model QuarantineConfig {
  id              String   @id @default(cuid())
  guildId         String   @unique @map("guild_id")
  roleId          String   @map("role_id")
  accessChannelId String   @map("access_channel_id")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  @@map("quarantine_config")
}

model GuildConfig {
  id           String   @id @default(cuid())
  guildId      String   @unique @map("guild_id")
  prefix       String   @default("!")
  blockedNames String[] @default([]) @map("blocked_names")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("guild_config")
}

model Verification {
  id                  String   @id @default(cuid())
  userId              String   @unique @map("user_id")
  youtubeProgress     Boolean  @default(false) @map("youtube_progress")
  instagramProgress   Boolean  @default(false) @map("instagram_progress")
  youtubeScreenshot   String?  @map("youtube_screenshot")
  instagramScreenshot String?  @map("instagram_screenshot")
  ocrYT               Json?    @map("ocr_yt")
  ocrIG               Json?    @map("ocr_ig")
  submittedForReview  Boolean  @default(false) @map("submitted_for_review")
  roleGiven           Boolean  @default(false) @map("role_given")
  status              String   @default("IDLE")
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")

  @@map("verifications")
}

model RoleAlias {
  id        String   @id @default(cuid())
  guildId   String   @map("guild_id")
  roleId    String   @map("role_id")
  alias     String
  createdAt DateTime @default(now()) @map("created_at")

  @@unique([guildId, alias])
  @@index([guildId])
  @@index([alias], map: "idx_role_aliases_alias")
  @@index([guildId], map: "idx_role_aliases_guild")
  @@map("role_aliases")
}

model WelcomeConfig {
  id               String   @id @default(cuid())
  guildId          String   @unique @map("guild_id")
  welcomeChannelId String?  @map("welcome_channel_id")
  leaveChannelId   String?  @map("leave_channel_id")
  welcomeMessage   String?  @map("welcome_message")
  leaveMessage     String?  @map("leave_message")
  welcomeEnabled   Boolean  @default(false) @map("welcome_enabled")
  leaveEnabled     Boolean  @default(false) @map("leave_enabled")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  @@map("welcome_config")
}

model AutoModConfig {
  id                 String   @id @default(cuid())
  guildId            String   @map("guild_id")
  type               String
  enabled            Boolean  @default(true)
  maxMessages        Int?     @default(5) @map("max_messages")
  timeSpanMs         Int?     @default(5000) @map("time_span_ms")
  maxLines           Int?     @default(10) @map("max_lines")
  maxMentions        Int?     @default(5) @map("max_mentions")
  punishmentType     String?  @default("timeout") @map("punishment_type")
  punishmentDuration Int?     @default(300) @map("punishment_duration")
  actionType         String?  @default("delete") @map("action_type")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  @@unique([guildId, type])
  @@index([guildId])
  @@map("automod_config")
}

model AutoModWhitelist {
  id         String   @id @default(cuid())
  guildId    String   @map("guild_id")
  type       String
  targetId   String   @map("target_id")
  targetType String   @map("target_type")
  createdBy  String   @map("created_by")
  createdAt  DateTime @default(now()) @map("created_at")

  @@unique([guildId, type, targetId])
  @@index([guildId, type])
  @@map("automod_whitelist")
}

model LoggingConfig {
  id               String   @id @default(cuid())
  guildId          String   @unique @map("guild_id")
  channelId        String?  @map("channel_id")
  enabled          Boolean  @default(false)
  logRoleCreate    Boolean  @default(true) @map("log_role_create")
  logRoleEdit      Boolean  @default(true) @map("log_role_edit")
  logRoleDelete    Boolean  @default(true) @map("log_role_delete")
  logChannelCreate Boolean  @default(true) @map("log_channel_create")
  logChannelEdit   Boolean  @default(true) @map("log_channel_edit")
  logChannelDelete Boolean  @default(true) @map("log_channel_delete")
  logMessageEdit   Boolean  @default(true) @map("log_message_edit")
  logMessageDelete Boolean  @default(true) @map("log_message_delete")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  @@map("logging_config")
}

model InviteCache {
  id         String   @id @default(cuid())
  guildId    String   @map("guild_id")
  code       String
  inviterId  String?  @map("inviter_id")
  inviterTag String?  @map("inviter_tag")
  uses       Int      @default(0)
  maxUses    Int      @default(0) @map("max_uses")
  temporary  Boolean  @default(false)
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  @@unique([guildId, code])
  @@index([guildId])
  @@index([inviterId])
  @@map("invite_cache")
}

model MemberJoinData {
  id         String   @id @default(cuid())
  guildId    String   @map("guild_id")
  userId     String   @map("user_id")
  inviterId  String?  @map("inviter_id")
  inviterTag String?  @map("inviter_tag")
  inviteCode String?  @map("invite_code")
  joinType   String   @map("join_type")
  joinedAt   DateTime @default(now()) @map("joined_at")

  @@unique([guildId, userId])
  @@index([guildId])
  @@index([inviterId])
  @@map("member_join_data")
}

model InviteTracker {
  id           String   @id @default(cuid())
  guildId      String   @map("guild_id")
  userId       String   @map("user_id")
  totalInvites Int      @default(0) @map("total_invites")
  leftInvites  Int      @default(0) @map("left_invites")
  fakeInvites  Int      @default(0) @map("fake_invites")
  bonusInvites Int      @default(0) @map("bonus_invites")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@unique([guildId, userId])
  @@index([userId])
}

model InviteRole {
  id        String   @id @default(cuid())
  guildId   String   @map("guild_id")
  roleId    String   @map("role_id")
  invites   Int
  createdAt DateTime @default(now()) @map("created_at")

  @@unique([guildId, invites])
  @@index([guildId])
  @@map("invite_roles")
}

model ServerStatsPanel {
  id               String   @id @default(cuid())
  guildId          String   @map("guild_id")
  panelName        String   @map("panel_name")
  channelType      String   @map("channel_type")
  categoryId       String   @map("category_id")
  totalChannelId   String   @map("total_channel_id")
  usersChannelId   String   @map("users_channel_id")
  botsChannelId    String   @map("bots_channel_id")
  onlineChannelId  String?  @map("online_channel_id")
  idleChannelId    String?  @map("idle_channel_id")
  dndChannelId     String?  @map("dnd_channel_id")
  offlineChannelId String?  @map("offline_channel_id")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  @@unique([guildId, panelName])
  @@index([guildId])
  @@map("server_stats_panels")
}

model Giveaway {
  id                    String                @id @default(cuid())
  messageId             String                @unique @map("message_id")
  channelId             String                @map("channel_id")
  guildId               String                @map("guild_id")
  hostId                String                @map("host_id")
  prize                 String
  winnersCount          Int                   @map("winners_count")
  endTime               DateTime              @map("end_time")
  ended                 Boolean               @default(false)
  createdAt             DateTime              @default(now()) @map("created_at")
  customMessage         String?               @map("custom_message")
  roleRequirement       String?               @map("role_requirement")
  inviteRequirement     Int?                  @map("invite_requirement")
  accountAgeRequirement Int?                  @map("account_age_requirement")
  serverAgeRequirement  Int?                  @map("server_age_requirement")
  captchaRequirement    Boolean               @default(false) @map("captcha_requirement")
  messageRequirement    Int?                  @map("message_requirement")
  voiceRequirement      Int?                  @map("voice_requirement")
  entryFee              Int?                  @map("entry_fee")
  assignRole            String?               @map("assign_role")
  thumbnail             String?
  emoji                 String?               @map("emoji")
  participants          GiveawayParticipant[]
  winners               GiveawayWinner[]

  @@index([guildId])
  @@map("giveaways")
}

model GiveawayParticipant {
  id         String   @id @default(cuid())
  giveawayId String   @map("giveaway_id")
  userId     String   @map("user_id")
  joinedAt   DateTime @default(now()) @map("joined_at")
  giveaway   Giveaway @relation(fields: [giveawayId], references: [id], onDelete: Cascade)

  @@unique([giveawayId, userId])
  @@map("giveaway_participants")
}

model GiveawayWinner {
  id         String   @id @default(cuid())
  giveawayId String   @map("giveaway_id")
  userId     String   @map("user_id")
  wonAt      DateTime @default(now()) @map("won_at")
  giveaway   Giveaway @relation(fields: [giveawayId], references: [id], onDelete: Cascade)

  @@map("giveaway_winners")
}

model AutoDragRule {
  id              String   @id @default(cuid())
  guildId         String   @map("guild_id")
  userId          String   @map("user_id")
  targetChannelId String   @map("target_channel_id")
  createdBy       String   @map("created_by")
  createdAt       DateTime @default(now()) @map("created_at")

  @@unique([guildId, userId])
  @@map("autodrag_rules")
}

model AutoAFKSettings {
  id           String   @id @default(cuid())
  guildId      String   @unique @map("guild_id")
  enabled      Boolean  @default(false)
  minutes      Int      @default(15)
  afkChannelId String   @map("afk_channel_id")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("autoafk_settings")
}

model UserStats {
  id                 String    @id @default(cuid())
  guildId            String    @map("guild_id")
  userId             String    @map("user_id")
  messageCount       Int       @default(0) @map("message_count")
  voiceMinutes       Int       @default(0) @map("voice_minutes")
  lastVoiceJoin      DateTime? @map("last_voice_join")
  createdAt          DateTime  @default(now()) @map("created_at")
  updatedAt          DateTime  @updatedAt @map("updated_at")
  dailyMessages      Int       @default(0) @map("daily_messages")
  dailyVoiceTime     BigInt    @default(0) @map("daily_voice_time")
  lastMessageDate    DateTime? @map("last_message_date")
  voiceTime          BigInt    @default(0) @map("voice_time")
  weeklyMessages     Int       @default(0) @map("weekly_messages")
  weeklyVoiceTime    BigInt    @default(0) @map("weekly_voice_time")
  lastVoiceChannelId String?   @map("last_voice_channel_id")

  @@unique([guildId, userId])
  @@index([guildId])
  @@index([userId])
  @@map("user_stats")
}

model UserDailyStats {
  id           String   @id @default(cuid())
  guildId      String   @map("guild_id")
  userId       String   @map("user_id")
  date         DateTime @db.Date
  messageCount Int      @default(0) @map("message_count")
  voiceTime    BigInt   @default(0) @map("voice_time")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@unique([guildId, userId, date])
  @@index([guildId, userId])
  @@index([date])
  @@map("user_daily_stats")
}

model UserChannelStats {
  id           String   @id @default(cuid())
  guildId      String   @map("guild_id")
  userId       String   @map("user_id")
  channelId    String   @map("channel_id")
  messageCount Int      @default(0) @map("message_count")
  voiceTime    BigInt   @default(0) @map("voice_time")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@unique([guildId, userId, channelId])
  @@index([guildId, userId])
  @@index([channelId])
  @@map("user_channel_stats")
}

model MessageConfig {
  id              String    @id @default(cuid())
  guildId         String    @unique @map("guild_id")
  dailyResetTime  String    @default("00:00") @map("daily_reset_time")
  weeklyResetTime String    @default("Sunday 00:00") @map("weekly_reset_time")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")
  lastDailyReset  DateTime? @map("last_daily_reset")
  lastWeeklyReset DateTime? @map("last_weekly_reset")

  @@map("message_config")
}

model MessageBlacklist {
  id        String   @id @default(cuid())
  guildId   String   @map("guild_id")
  targetId  String   @map("target_id")
  type      String
  createdAt DateTime @default(now()) @map("created_at")

  @@unique([guildId, targetId])
  @@index([guildId])
  @@map("message_blacklist")
}

model MessageRole {
  id           String   @id @default(cuid())
  guildId      String   @map("guild_id")
  roleId       String   @map("role_id")
  messageCount Int      @map("message_count")
  createdAt    DateTime @default(now()) @map("created_at")

  @@unique([guildId, messageCount])
  @@index([guildId])
  @@map("message_roles")
}

model VoiceConfig {
  id              String    @id @default(cuid())
  guildId         String    @unique @map("guild_id")
  dailyResetTime  String    @default("00:00") @map("daily_reset_time")
  weeklyResetTime String    @default("Sunday 00:00") @map("weekly_reset_time")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")
  lastDailyReset  DateTime? @map("last_daily_reset")
  lastWeeklyReset DateTime? @map("last_weekly_reset")

  @@map("voice_config")
}

model data {
  id        String   @id
  type      String
  data      Json
  updatedAt DateTime @default(now()) @db.Timestamp(6)

  @@index([data], map: "idx_data_gin", type: Gin)
  @@index([type], map: "idx_type")
  @@index([updatedAt], map: "idx_updated")
}
